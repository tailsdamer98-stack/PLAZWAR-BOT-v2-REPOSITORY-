# PLAZWAR-BOT-v2-REPOSITORY-
–ú—ã –∏–º–µ–µ–º –¥–≤–∞ –∫—É—Å–∫–∞ –∫–æ–¥–∞. –ü–µ—Ä–≤—ã–π - —ç—Ç–æ –∫–æ–¥ –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω—É–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.
–í—Ç–æ—Ä–æ–π - —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –¥–æ–ª–∂–Ω—ã –≤–∑—è—Ç—å –∑–∞ –æ—Å–Ω–æ–≤—É –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞.

–ó–∞–¥–∞—á–∞: –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –∫–æ–¥–∞ (—Å–∏—Å—Ç–µ–º–∞ PL, –ø–µ—Ä–µ–≤–æ–¥, —Ç–æ–ø, –ø—Ä–æ—Ñ–∏–ª—å, –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è)
–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—Ç–æ—Ä–æ–≥–æ –∫–æ–¥–∞ (–∫–æ–º–∞–Ω–¥—ã /start, /help, /proshop, /profile, /give –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–∞—Ö).

–ü—Ä–∏ —ç—Ç–æ–º –Ω—É–∂–Ω–æ —É—á–µ—Å—Ç—å:

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –º–æ–ª—á–∞—Ç—å –≤ —á—É–∂–∏—Ö —á–∞—Ç–∞—Ö (–∫—Ä–æ–º–µ plazchat).

–í plazchat –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ –∫–æ–º–∞–Ω–¥—ã (–ø—Ä–æ—Ñ–∏–ª—å, —Ç–æ–ø, –ø–µ—Ä–µ–¥–∞—Ç—å, –∏–Ω—Ñ, –±–∞–ª–∞–Ω—Å) –∏ –Ω–∞—á–∏—Å–ª—è–µ—Ç PL –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è.

–í –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é.

ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏ (–Ω–µ –º–µ–Ω—è—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ).

–í –∫–æ–º–∞–Ω–¥–µ /help –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç –∏ —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–µ–π.

–í –∫–æ–º–∞–Ω–¥–µ /proshop –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å, –∏–ª–∏ —Ç–µ–∫—Å—Ç.

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è PL –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ plazchat (–ø–æ—Å–ª–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π).

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–≤–æ–¥ PL (–∫–æ–º–∞–Ω–¥–∞ /give –∏ —Å–ª–æ–≤–æ "–ø–µ—Ä–µ–¥–∞—Ç—å" –≤ plazchat).

–í –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö –≤ –ª–∏—á–∫–µ –±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–∏—Å–∞—Ç—å "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞".

–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –ø–µ—Ä–≤–æ–º –∫–æ–¥–µ, –∏ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –±–æ—Ç –Ω–µ –ø–∞–¥–∞–ª.

–ü–ª–∞–Ω:

–°–æ–∑–¥–∞–¥–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å–ª–æ–≤–∞—Ä—å –≤ –ø–∞–º—è—Ç–∏, –Ω–æ –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö).

–†–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (get_or_create_user, transfer_pl, get_top_users).

–ù–∞—Å—Ç—Ä–æ–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –¥–ª—è –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –¥–ª—è —á–∞—Ç–∞ plazchat.

–í plazchat –±—É–¥–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (–ø—Ä–æ—Ñ–∏–ª—å, —Ç–æ–ø, –ø–µ—Ä–µ–¥–∞—Ç—å, –∏–Ω—Ñ, –±–∞–ª–∞–Ω—Å) –∏ –Ω–∞—á–∏—Å–ª—è—Ç—å PL –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è.

–í –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã (/start, /help, /proshop, /profile, /give, /top) –∏ –Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–≤–∫–ª—é—á–∞—è —Ç–µ–∫—Å—Ç) –æ—Ç–≤–µ—á–∞–µ–º "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞".

–ë–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Ç–∞—Ö.

–í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

–í plazchat –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω—ã –±–µ–∑ —Å–ª—ç—à–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ø—Ä–æ—Ñ–∏–ª—å"), –∞ –≤ –ª–∏—á–∫–µ —Ç–æ–ª—å–∫–æ —Å–æ —Å–ª—ç—à–µ–º.

–í plazchat –±–æ—Ç —Ç–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è —Å —Å–ª—ç—à–∞, –Ω–æ –º—ã –∏—Ö –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º (–∫–∞–∫ –≤ –ø–µ—Ä–≤–æ–º –∫–æ–¥–µ), —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –¥—Ä—É–≥–∏–º –±–æ—Ç–∞–º.

–£—á—Ç–µ–º, —á—Ç–æ –≤ –ø–µ—Ä–≤–æ–º –∫–æ–¥–µ –µ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–∞—Ö (plazchat –∏ —Ç–µ—Å—Ç-–≥—Ä—É–ø–ø–∞). –ú—ã –æ—Å—Ç–∞–≤–∏–º —Ç–æ–ª—å–∫–æ plazchat.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

–í –∫–æ–º–∞–Ω–¥–µ /help –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∂–∏—Ä–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º –∏ —Ü–∏—Ç–∞—Ç–∞–º–∏.

–í –∫–æ–º–∞–Ω–¥–µ /profile –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å–æ–æ–±—â–µ–Ω–∏—è, PL, –∑–≤–∞–Ω–∏–µ).

–ü—Ä–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ PL –≤ plazchat: –ø–æ—Å–ª–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞—á–∏—Å–ª—è—Ç—å 0.5 PL –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º –ø–∏—Å–∞—Ç—å –∫–æ–¥.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∫–æ–¥ –±—É–¥–µ—Ç –¥–ª–∏–Ω–Ω—ã–º, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å.

–®–∞–≥–∏:

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

–ó–∞–¥–∞–µ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã.

–°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

–°–æ–∑–¥–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

–í–∞–∂–Ω–æ: —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–∫–∏ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏, –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å try-except.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤–æ –≤—Ç–æ—Ä–æ–º –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è parse_mode='HTML', –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTML-—Ç–µ–≥–∏ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–î–ª—è —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ HTML –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–≥ <blockquote>.

–ö–æ–º–∞–Ω–¥–∞ /help –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏.

–¢–∞–∫–∂–µ —É—á—Ç–µ–º, —á—Ç–æ –≤ plazchat –±–æ—Ç –¥–æ–ª–∂–µ–Ω –º–æ–ª—á–∞—Ç—å –Ω–∞ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫—Ä–æ–º–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –≤—Å—Ç—É–ø–∏—Ç—å/–≤—ã–π—Ç–∏).
–ù–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–∞—á–∏—Å–ª—è—Ç—å PL –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—Å –∞–Ω—Ç–∏—Ñ–ª—É–¥–æ–º).

–í –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –±–æ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ –∫–æ–º–∞–Ω–¥ (–∏ –±–µ–∑ —Å–ª—ç—à–∞) –æ—Ç–≤–µ—á–∞–µ—Ç "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞".

–†–µ–∞–ª–∏–∑—É–µ–º:

–í plazchat:

–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ (–ø—Ä–æ—Ñ–∏–ª—å, —Ç–æ–ø, –±–∞–ª–∞–Ω—Å, –∏–Ω—Ñ, –ø–µ—Ä–µ–¥–∞—Ç—å) –∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (–≤—Å—Ç—É–ø–∏—Ç—å, –≤—ã–π—Ç–∏).

–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ PL –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å —É—á–µ—Ç–æ–º –∞–Ω—Ç–∏—Ñ–ª—É–¥–∞ –∏ –ø–æ—Ä–æ–≥–∞ –≤ 100 —Å–æ–æ–±—â–µ–Ω–∏–π).

–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ —Å–æ —Å–ª—ç—à–µ–º (—á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å –¥—Ä—É–≥–∏–º –±–æ—Ç–∞–º).

–í –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö:

–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ —Å–æ —Å–ª—ç—à–µ–º (/start, /help, /proshop, /profile, /give, /top).

–ù–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–±–µ–∑ —Å–ª—ç—à–∞) –æ—Ç–≤–µ—á–∞—Ç—å "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞".

–í –¥—Ä—É–≥–∏—Ö —á–∞—Ç–∞—Ö –±–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –≤–æ–æ–±—â–µ.

–î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö.

–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –≤ plazchat –∫–æ–º–∞–Ω–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç—Å—è —Å–æ —Å–ª—ç—à–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, /start) –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –±–æ—Ç–æ–º (–Ω–æ –¥—Ä—É–≥–∏–º–∏ –±–æ—Ç–∞–º–∏ –º–æ–≥–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è).

–í –ø–µ—Ä–≤–æ–º –∫–æ–¥–µ –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è ignore_commands_active_chat, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ—Å—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–ª–∞.

–ú—ã –∂–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å–æ —Å–ª—ç—à–µ–º –≤ plazchat.

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –∫–æ–¥–∞, —è –±—É–¥—É –ø–∏—Å–∞—Ç—å –∫–æ–¥ —á–∞—Å—Ç—è–º–∏, –Ω–æ –ø–æ—Å—Ç–∞—Ä–∞—é—Å—å —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ —Ü–µ–ª—å–Ω—ã–º.

–ö–û–ù–¶–ï–ü–¢ –°–ò–°–¢–ï–ú–´ –¢–†–ò–ì–ì–ï–†–ù–´–• –°–õ–û–í –î–õ–Ø TELEGRAM –ë–û–¢–ê PLAZWAR
üöÄ –ü–û–õ–ù–´–ô –ö–û–î –° –¢–†–ò–ì–ì–ï–†–ê–ú–ò (TeleBot API):
python
import telebot
import json
import time
import os
from datetime import datetime
from typing import Dict, List, Optional

# ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
BOT_TOKEN = '8553117129:AAGK879g24Rd7QAdwLk5bHl9DOK2Rl9zfYA'
bot = telebot.TeleBot(BOT_TOKEN, parse_mode='HTML')

# ID —á–∞—Ç–∞ plazchat
PLAZCHAT_CHAT_ID = -1002222950483  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID —á–∞—Ç–∞ @plazchat

# –ü—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º
USERS_FILE = 'users.json'
TRIGGERS_FILE = 'triggers.json'
WARNINGS_FILE = 'warnings.json'

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
WARNINGS_LIMIT = 3  # –ú–∞–∫—Å–∏–º—É–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –±–∞–Ω–∞
BAN_DURATION = 3600  # –í—Ä–µ–º—è –±–∞–Ω–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö (1 —á–∞—Å)

# ========== –°–¢–†–£–ö–¢–£–†–´ –î–ê–ù–ù–´–• ==========
class DataStorage:
    """–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏"""
    
    @staticmethod
    def load_json(filename: str, default=None):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON —Ñ–∞–π–ª–∞"""
        try:
            if os.path.exists(filename):
                with open(filename, 'r', encoding='utf-8') as f:
                    return json.load(f)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ {filename}: {e}")
        return default or {}
    
    @staticmethod
    def save_json(filename: str, data):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(filename, 'w', encoding='utf-8') as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è {filename}: {e}")

# ========== –¢–†–ò–ì–ì–ï–†–ù–ê–Ø –°–ò–°–¢–ï–ú–ê ==========
class TriggerSystem:
    """–°–∏—Å—Ç–µ–º–∞ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Å–ª–æ–≤ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏"""
    
    def __init__(self):
        self.triggers = DataStorage.load_json(TRIGGERS_FILE, [])
        self.warnings = DataStorage.load_json(WARNINGS_FILE, {})
        self.users = DataStorage.load_json(USERS_FILE, {})
        
        # –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (–µ—Å–ª–∏ —Ñ–∞–π–ª –ø—É—Å—Ç–æ–π)
        if not self.triggers:
            self.triggers = [
                "—Ä–µ–∫–ª–∞–º–∞", "—Å–ø–∞–º", "–æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ", "–º–∞—Ç", 
                "—Å–∫–∞–º", "—Ä–∞–∑–≤–æ–¥", "–æ–±–º–∞–Ω", "–ø–æ—Ä–Ω–æ", 
                "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–æ—Ä—É–∂–∏–µ", "–Ω–∞—Å–∏–ª–∏–µ", "–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ"
            ]
            DataStorage.save_json(TRIGGERS_FILE, self.triggers)
    
    def check_message(self, message) -> List[str]:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã"""
        if not message.text:
            return []
        
        text = message.text.lower()
        found_triggers = []
        
        for trigger in self.triggers:
            if trigger in text:
                found_triggers.append(trigger)
        
        return found_triggers
    
    def add_warning(self, user_id: int) -> int:
        """–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        user_id_str = str(user_id)
        
        if user_id_str not in self.warnings:
            self.warnings[user_id_str] = {
                'count': 0,
                'history': [],
                'last_warning': None
            }
        
        self.warnings[user_id_str]['count'] += 1
        self.warnings[user_id_str]['last_warning'] = time.time()
        self.warnings[user_id_str]['history'].append({
            'time': time.time(),
            'reason': '–¢—Ä–∏–≥–≥–µ—Ä–Ω–æ–µ —Å–ª–æ–≤–æ'
        })
        
        DataStorage.save_json(WARNINGS_FILE, self.warnings)
        return self.warnings[user_id_str]['count']
    
    def get_warnings(self, user_id: int) -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö"""
        user_id_str = str(user_id)
        return self.warnings.get(user_id_str, {'count': 0, 'history': []})
    
    def reset_warnings(self, user_id: int) -> bool:
        """–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"""
        user_id_str = str(user_id)
        if user_id_str in self.warnings:
            del self.warnings[user_id_str]
            DataStorage.save_json(WARNINGS_FILE, self.warnings)
            return True
        return False
    
    def add_trigger(self, trigger: str) -> bool:
        """–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä"""
        if trigger.lower() not in self.triggers:
            self.triggers.append(trigger.lower())
            DataStorage.save_json(TRIGGERS_FILE, self.triggers)
            return True
        return False
    
    def remove_trigger(self, trigger: str) -> bool:
        """–£–¥–∞–ª–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä"""
        if trigger.lower() in self.triggers:
            self.triggers.remove(trigger.lower())
            DataStorage.save_json(TRIGGERS_FILE, self.triggers)
            return True
        return False
    
    def get_triggers(self) -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤"""
        return self.triggers

# ========== –°–ò–°–¢–ï–ú–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô ==========
class UserSystem:
    """–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è PL"""
    
    def __init__(self):
        self.users = DataStorage.load_json(USERS_FILE, {})
        self.last_message_time = {}
        self.PL_REWARD = 0.5
        self.MESSAGE_THRESHOLD = 100
    
    def get_or_create_user(self, telegram_id: int, username: str = "") -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user_id_str = str(telegram_id)
        
        if user_id_str not in self.users:
            # –ù–∞–∑–Ω–∞—á–∞–µ–º ID –ø–æ –ø–æ—Ä—è–¥–∫—É
            new_id = len(self.users) + 1000
            username_clean = username.replace('@', '') if username else f"user{telegram_id}"
            
            self.users[user_id_str] = {
                'username': username_clean,
                'messages': 0,
                'pl': 0.0,
                'user_id': new_id,
                'registered': datetime.now().isoformat(),
                'clan': None,
                'strikes': 0,
                'level': 1,
                'last_active': time.time()
            }
            DataStorage.save_json(USERS_FILE, self.users)
        
        elif username and '@' in username:
            # –û–±–Ω–æ–≤–ª—è–µ–º username –µ—Å–ª–∏ –µ—Å—Ç—å @
            self.users[user_id_str]['username'] = username.replace('@', '')
            DataStorage.save_json(USERS_FILE, self.users)
        
        return self.users[user_id_str]
    
    def add_message(self, telegram_id: int) -> float:
        """–î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –Ω–∞—á–∏—Å–ª–∏—Ç—å PL"""
        user = self.get_or_create_user(telegram_id)
        user['messages'] += 1
        user['last_active'] = time.time()
        
        # –ù–∞—á–∏—Å–ª—è–µ–º PL –ø–æ—Å–ª–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
        if user['messages'] >= self.MESSAGE_THRESHOLD:
            pl_to_add = self.PL_REWARD
            user['pl'] = round(user.get('pl', 0) + pl_to_add, 2)
        
        DataStorage.save_json(USERS_FILE, self.users)
        return user['pl']
    
    def transfer_pl(self, sender_id: int, target_id: int, amount: float) -> str:
        """–ü–µ—Ä–µ–≤–æ–¥ PL –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"""
        try:
            if amount <= 0:
                return "‚ùóÔ∏è–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0!"
            
            sender = self.get_or_create_user(sender_id)
            
            if sender['pl'] < amount:
                return f"‚ùóÔ∏è–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ PL! –£ –≤–∞—Å: {sender['pl']:.2f}"
            
            # –ò—â–µ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è –ø–æ user_id
            target_user = None
            target_telegram_id = None
            
            for tg_id, user_data in self.users.items():
                if user_data['user_id'] == target_id:
                    target_user = user_data
                    target_telegram_id = int(tg_id)
                    break
            
            if not target_user:
                return f"‚ùì–ò–≥—Ä–æ–∫ —Å ID {target_id} –Ω–µ –Ω–∞–π–¥–µ–Ω"
            
            # –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–≤–æ–¥
            sender['pl'] = round(sender['pl'] - amount, 2)
            target_user['pl'] = round(target_user.get('pl', 0) + amount, 2)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—Ç–µ–ª—è
            self.users[str(target_telegram_id)] = target_user
            DataStorage.save_json(USERS_FILE, self.users)
            
            return f"‚úÖ –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–æ {amount:.2f} PL –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {target_user['username']} (ID: {target_id})"
        
        except Exception as e:
            return f"‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞: {str(e)}"
    
    def get_top_users(self, limit: int = 10) -> str:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        if not self.users:
            return "üìä –ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ PL
        sorted_users = sorted(
            self.users.items(),
            key=lambda x: x[1].get('pl', 0),
            reverse=True
        )[:limit]
        
        result = "üèÜ <b>–¢–û–ü –ò–ì–†–û–ö–û–í –ü–û PL:</b>\n\n"
        for i, (telegram_id, user_data) in enumerate(sorted_users, 1):
            username = user_data['username']
            pl = user_data.get('pl', 0)
            user_id = user_data['user_id']
            result += f"{i}. <b>{username}</b> (ID: {user_id}) - {pl:.2f} PL\n"
        
        return result
    
    def anti_flood(self, user_id: int, delay: int = 2) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ñ–ª—É–¥"""
        current_time = time.time()
        
        if user_id in self.last_message_time:
            time_diff = current_time - self.last_message_time[user_id]
            if time_diff < delay:
                return False
        
        self.last_message_time[user_id] = current_time
        return True

# ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ò–°–¢–ï–ú ==========
trigger_system = TriggerSystem()
user_system = UserSystem()

# ========== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–Ø ==========
ADMIN_IDS = []  # –î–æ–±–∞–≤—å—Ç–µ —Å—é–¥–∞ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

def is_admin(user_id: int) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"""
    return user_id in ADMIN_IDS

# ========== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –ö–û–ú–ê–ù–î ==========

# –ö–æ–º–∞–Ω–¥–∞ /start
@bot.message_handler(commands=['start'])
def start_command(message):
    chat_type = message.chat.type
    
    if chat_type == 'private':
        welcome_text = """<b>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ PLAZWAR!</b>

–Ø - –±–æ—Ç –¥–ª—è –∏–≥—Ä–æ–≤–æ–≥–æ —á–∞—Ç–∞ @plazchat
–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ:
‚Ä¢ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å PL –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∞—Ç–µ
‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥–∏—Ç—å PL –¥—Ä—É–≥–∏–º –∏–≥—Ä–æ–∫–∞–º
‚Ä¢ –°–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤
‚Ä¢ –£–ø—Ä–∞–≤–ª—è—Ç—å –∫–ª–∞–Ω–∞–º–∏

<b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/profile - –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å
/help - –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞
/proshop - –º–∞–≥–∞–∑–∏–Ω
/top - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
/give - –ø–µ—Ä–µ–≤–æ–¥ PL

<b>–ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø):</b>
/triggers - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏
/warnings - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
/ban - –∑–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        
        bot.reply_to(message, welcome_text, parse_mode='HTML')
    
    elif message.chat.id == PLAZCHAT_CHAT_ID:
        bot.reply_to(message, "ü§ñ –ë–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω –≤ —ç—Ç–æ–º —á–∞—Ç–µ! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –±–µ–∑ '/'")

# –ö–æ–º–∞–Ω–¥–∞ /help
@bot.message_handler(commands=['help'])
def help_command(message):
    if message.chat.type == 'private':
        help_text = """<b>üìö –ü–û–ú–û–©–¨ –ò –ö–û–ú–ê–ù–î–´</b>

<b>1Ô∏è‚É£ PL ‚Äì Points Labor</b>
‚Ä¢ PL –≤—ã–¥–∞—é—Ç—Å—è –∑–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∞—Ç–µ @plazchat
‚Ä¢ –ü–æ—Å–ª–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π: +0.5 PL –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ PL —Å–≥–æ—Ä–∞—é—Ç –ø–æ—Å–ª–µ 7 –¥–Ω–µ–π –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

<b>2Ô∏è‚É£ –ö–ª–∞–Ω—ã</b>
<blockquote>‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–Ω–∞: 3000 PL
‚Ä¢ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ: –Ω–∞–ø–∏—à–∏—Ç–µ –≤ —á–∞—Ç–µ "–≤—Å—Ç—É–ø–∏—Ç—å [–Ω–∞–∑–≤–∞–Ω–∏–µ]"
‚Ä¢ –í—ã—Ö–æ–¥: –Ω–∞–ø–∏—à–∏—Ç–µ "–≤—ã–π—Ç–∏ [–Ω–∞–∑–≤–∞–Ω–∏–µ]"
‚Ä¢ –ú–∞–∫—Å–∏–º—É–º: 20 —á–µ–ª–æ–≤–µ–∫ –≤ –∫–ª–∞–Ω–µ
‚Ä¢ –£—Ä–æ–≤–Ω–∏: –ø—Ä–æ–∫–∞—á–∏–≤–∞—é—Ç—Å—è –æ–ø—ã—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –†–µ–π–¥—ã: –∫–æ–º–∞–Ω–¥–∞ /raid –¥–ª—è –∞—Ç–∞–∫–∏ –¥—Ä—É–≥–∏—Ö –∫–ª–∞–Ω–æ–≤</blockquote>

<b>3Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</b>
‚Ä¢ <b>/profile</b> - –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å
‚Ä¢ <b>/top</b> - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
‚Ä¢ <b>/give [ID] [—Å—É–º–º–∞]</b> - –ø–µ—Ä–µ–≤–æ–¥ PL
‚Ä¢ <b>/proshop</b> - –º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤
‚Ä¢ <b>/clan</b> - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–Ω–æ–º

<b>4Ô∏è‚É£ –í —á–∞—Ç–µ @plazchat</b>
‚Ä¢ <b>–ø—Ä–æ—Ñ–∏–ª—å</b> - –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
‚Ä¢ <b>—Ç–æ–ø</b> - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤
‚Ä¢ <b>–±–∞–ª–∞–Ω—Å</b> - –≤–∞—à –±–∞–ª–∞–Ω—Å PL
‚Ä¢ <b>–∏–Ω—Ñ [ID]</b> - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥—Ä–æ–∫–µ
‚Ä¢ <b>–ø–µ—Ä–µ–¥–∞—Ç—å [ID] [—Å—É–º–º–∞]</b> - –ø–µ—Ä–µ–≤–æ–¥ PL

<b>5Ô∏è‚É£ –ê–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã</b>
‚Ä¢ <b>/triggers</b> - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏
‚Ä¢ <b>/warnings @user</b> - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
‚Ä¢ <b>/ban @user</b> - –±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚Ä¢ <b>/unban @user</b> - —Ä–∞–∑–±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        
        bot.reply_to(message, help_text, parse_mode='HTML')

# –ö–æ–º–∞–Ω–¥–∞ /profile
@bot.message_handler(commands=['profile'])
def profile_command(message):
    user = user_system.get_or_create_user(
        message.from_user.id,
        message.from_user.username or message.from_user.first_name
    )
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–≤–∞–Ω–∏–µ
    messages = user['messages']
    if messages < 100:
        rank = "–ü—Ä–æ—Ö–æ–¥–∏–º–µ—Ü"
        progress = f"{messages}/100"
    elif messages < 500:
        rank = "–í–æ–∏–Ω"
        progress = f"{messages}/500"
    elif messages < 1000:
        rank = "–í–µ—Ç–µ—Ä–∞–Ω"
        progress = f"{messages}/1000"
    else:
        rank = "–õ–µ–≥–µ–Ω–¥–∞"
        progress = f"{messages}+"
    
    profile_text = f"""<b>üë§ –ü–†–û–§–ò–õ–¨ –ò–ì–†–û–ö–ê</b>

üöµ‚Äç‚ôÄÔ∏è <b>–ù–∏–∫:</b> {user['username']}
ü™™ <b>ID:</b> {user['user_id']}
‚öîÔ∏è <b>–ó–≤–∞–Ω–∏–µ:</b> {rank} ({progress})
üí∑ <b>PL:</b> {user['pl']:.2f}
üè∞ <b>–ö–ª–∞–Ω:</b> {user['clan'] or '–ù–µ—Ç'}
üé≥ <b>–°—Ç—Ä–∞–π–∫–∏:</b> {user['strikes']} // 0 –æ–ø–µ–Ω
üìÖ <b>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:</b> {datetime.fromisoformat(user['registered']).strftime('%d.%m.%Y')}"""
    
    bot.reply_to(message, profile_text, parse_mode='HTML')

# –ö–æ–º–∞–Ω–¥–∞ /top
@bot.message_handler(commands=['top'])
def top_command(message):
    top_text = user_system.get_top_users(10)
    bot.reply_to(message, top_text, parse_mode='HTML')

# –ö–æ–º–∞–Ω–¥–∞ /give
@bot.message_handler(commands=['give'])
def give_command(message):
    try:
        args = message.text.split()[1:]  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º /give
        
        if len(args) != 2:
            bot.reply_to(message, "‚ùå <b>–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç!</b>\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: <code>/give [ID] [—Å—É–º–º–∞]</code>\n–ü—Ä–∏–º–µ—Ä: <code>/give 1001 50.5</code>", parse_mode='HTML')
            return
        
        target_id = int(args[0])
        amount = float(args[1])
        
        result = user_system.transfer_pl(message.from_user.id, target_id, amount)
        bot.reply_to(message, result, parse_mode='HTML')
    
    except (ValueError, IndexError):
        bot.reply_to(message, "‚ùå <b>–û—à–∏–±–∫–∞ –≤–≤–æ–¥–∞!</b>\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: <code>/give [ID] [—Å—É–º–º–∞]</code>\n–ü—Ä–∏–º–µ—Ä: <code>/give 1001 50.5</code>", parse_mode='HTML')

# ========== –ê–î–ú–ò–ù –ö–û–ú–ê–ù–î–´ ==========

# –ö–æ–º–∞–Ω–¥–∞ /triggers
@bot.message_handler(commands=['triggers'])
def triggers_command(message):
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    args = message.text.split()[1:] if len(message.text.split()) > 1 else []
    
    if not args:
        # –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
        triggers_list = trigger_system.get_triggers()
        if triggers_list:
            text = "üìã <b>–°–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Å–ª–æ–≤:</b>\n\n"
            for i, trigger in enumerate(triggers_list, 1):
                text += f"{i}. {trigger}\n"
            text += "\n<b>–î–æ–±–∞–≤–∏—Ç—å:</b> /triggers add [—Å–ª–æ–≤–æ]\n<b>–£–¥–∞–ª–∏—Ç—å:</b> /triggers remove [—Å–ª–æ–≤–æ]"
        else:
            text = "üì≠ –°–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø—É—Å—Ç"
        
        bot.reply_to(message, text, parse_mode='HTML')
        return
    
    action = args[0].lower()
    
    if action == 'add' and len(args) > 1:
        new_trigger = ' '.join(args[1:])
        if trigger_system.add_trigger(new_trigger):
            bot.reply_to(message, f"‚úÖ –¢—Ä–∏–≥–≥–µ—Ä '{new_trigger}' –¥–æ–±–∞–≤–ª–µ–Ω")
        else:
            bot.reply_to(message, f"‚ö†Ô∏è –¢—Ä–∏–≥–≥–µ—Ä '{new_trigger}' —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
    
    elif action == 'remove' and len(args) > 1:
        trigger_to_remove = ' '.join(args[1:])
        if trigger_system.remove_trigger(trigger_to_remove):
            bot.reply_to(message, f"‚úÖ –¢—Ä–∏–≥–≥–µ—Ä '{trigger_to_remove}' —É–¥–∞–ª–µ–Ω")
        else:
            bot.reply_to(message, f"‚ùå –¢—Ä–∏–≥–≥–µ—Ä '{trigger_to_remove}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
    
    else:
        bot.reply_to(message, "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:\n/triggers - —Å–ø–∏—Å–æ–∫\n/triggers add [—Å–ª–æ–≤–æ] - –¥–æ–±–∞–≤–∏—Ç—å\n/triggers remove [—Å–ª–æ–≤–æ] - —É–¥–∞–ª–∏—Ç—å")

# –ö–æ–º–∞–Ω–¥–∞ /warnings
@bot.message_handler(commands=['warnings'])
def warnings_command(message):
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    args = message.text.split()[1:] if len(message.text.split()) > 1 else []
    
    if not args:
        # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º
        warnings_data = trigger_system.warnings
        
        if not warnings_data:
            bot.reply_to(message, "üì≠ –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π")
            return
        
        text = "‚ö†Ô∏è <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏:</b>\n\n"
        
        for user_id_str, data in list(warnings_data.items())[:20]:  # –û–≥—Ä–∞–Ω–∏—á–∏–º –≤—ã–≤–æ–¥
            count = data['count']
            text += f"ID: {user_id_str} - {count} –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π\n"
        
        if len(warnings_data) > 20:
            text += f"\n... –∏ –µ—â–µ {len(warnings_data) - 20} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
        
        bot.reply_to(message, text, parse_mode='HTML')
        return
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    user_mention = args[0]
    
    # –ü–∞—Ä—Å–∏–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è
    if user_mention.startswith('@'):
        # –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ username
        # –í —Ä–µ–∞–ª—å–Ω–æ–º –±–æ—Ç–µ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫
        bot.reply_to(message, "‚ö†Ô∏è –ü–æ–∏—Å–∫ –ø–æ username –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.")
        return
    else:
        try:
            user_id = int(user_mention)
            warnings = trigger_system.get_warnings(user_id)
            
            if warnings['count'] > 0:
                text = f"‚ö†Ô∏è <b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}:</b>\n\n"
                text += f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {warnings['count']}\n"
                
                if warnings['history']:
                    text += "\n<b>–ò—Å—Ç–æ—Ä–∏—è:</b>\n"
                    for warn in warnings['history'][-5:]:  # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5
                        time_str = datetime.fromtimestamp(warn['time']).strftime('%d.%m.%Y %H:%M')
                        text += f"‚Ä¢ {time_str}: {warn['reason']}\n"
                
                text += f"\n<b>–°–±—Ä–æ—Å–∏—Ç—å:</b> /reset_warnings {user_id}"
            else:
                text = f"‚úÖ –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} –Ω–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π"
            
            bot.reply_to(message, text, parse_mode='HTML')
        
        except ValueError:
            bot.reply_to(message, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")

# –ö–æ–º–∞–Ω–¥–∞ /reset_warnings
@bot.message_handler(commands=['reset_warnings'])
def reset_warnings_command(message):
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    args = message.text.split()[1:] if len(message.text.split()) > 1 else []
    
    if not args:
        bot.reply_to(message, "‚ùå –£–∫–∞–∂–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: /reset_warnings [ID]")
        return
    
    try:
        user_id = int(args[0])
        if trigger_system.reset_warnings(user_id):
            bot.reply_to(message, f"‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} —Å–±—Ä–æ—à–µ–Ω—ã")
        else:
            bot.reply_to(message, f"‚ö†Ô∏è –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} –Ω–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π")
    except ValueError:
        bot.reply_to(message, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")

# –ö–æ–º–∞–Ω–¥–∞ /ban
@bot.message_handler(commands=['ban'])
def ban_command(message):
    if not is_admin(message.from_user.id):
        bot.reply_to(message, "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤")
        return
    
    if message.chat.type not in ['group', 'supergroup']:
        bot.reply_to(message, "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–∞—Ö")
        return
    
    if not message.reply_to_message:
        bot.reply_to(message, "‚ùå –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–∞–Ω–∏—Ç—å")
        return
    
    target_user = message.reply_to_message.from_user
    
    try:
        # –ë–∞–Ω –≤ —á–∞—Ç–µ
        bot.ban_chat_member(
            chat_id=message.chat.id,
            user_id=target_user.id,
            until_date=int(time.time()) + BAN_DURATION
        )
        
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        trigger_system.reset_warnings(target_user.id)
        
        bot.reply_to(message, f"‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{target_user.username or target_user.id} –∑–∞–±–∞–Ω–µ–Ω –Ω–∞ 1 —á–∞—Å")
    
    except Exception as e:
        bot.reply_to(message, f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –±–∞–Ω–µ: {str(e)}")

# ========== –û–ë–†–ê–ë–û–¢–ö–ê –°–û–û–ë–©–ï–ù–ò–ô –í –ß–ê–¢–ï PLAZCHAT ==========

@bot.message_handler(func=lambda m: m.chat.id == PLAZCHAT_CHAT_ID)
def handle_plazchat_message(message):
    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã —Å / (–∏—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –¥—Ä—É–≥–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã)
    if message.text and message.text.startswith('/'):
        return
    
    user_id = message.from_user.id
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ñ–ª—É–¥
    if not user_system.anti_flood(user_id):
        return
    
    # 1. –ù–ê–ß–ò–°–õ–ï–ù–ò–ï PL –ó–ê –°–û–û–ë–©–ï–ù–ò–ï
    new_balance = user_system.add_message(user_id)
    
    # 2. –ü–†–û–í–ï–†–ö–ê –ù–ê –¢–†–ò–ì–ì–ï–†–ù–´–ï –°–õ–û–í–ê
    found_triggers = trigger_system.check_message(message)
    
    if found_triggers:
        # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        try:
            bot.delete_message(message.chat.id, message.message_id)
        except:
            pass
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
        warning_count = trigger_system.add_warning(user_id)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏
        warning_msg = f"""‚ö†Ô∏è <b>–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï!</b>

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @{message.from_user.username or message.from_user.id}
–ù–∞—Ä—É—à–µ–Ω–∏–µ: –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–µ —Å–ª–æ–≤–∞
–°–ª–æ–≤–∞: {', '.join(found_triggers)}

<b>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ {warning_count}/{WARNINGS_LIMIT}</b>
–°–ª–µ–¥—É—é—â–µ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –±–∞–Ω—É!"""
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
        sent_msg = bot.reply_to(message, warning_msg, parse_mode='HTML')
        
        # –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
        time.sleep(10)
        try:
            bot.delete_message(message.chat.id, sent_msg.message_id)
        except:
            pass
        
        # –ï—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π - –±–∞–Ω
        if warning_count >= WARNINGS_LIMIT:
            try:
                bot.ban_chat_member(
                    chat_id=message.chat.id,
                    user_id=user_id,
                    until_date=int(time.time()) + BAN_DURATION
                )
                
                ban_msg = f"‚õîÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{message.from_user.username or user_id} –∑–∞–±–∞–Ω–µ–Ω –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏—è!"
                bot.send_message(message.chat.id, ban_msg, parse_mode='HTML')
                
                # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
                trigger_system.reset_warnings(user_id)
            
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –±–∞–Ω–∞: {e}")
        
        return
    
    # 3. –û–ë–†–ê–ë–û–¢–ö–ê –¢–ï–ö–°–¢–û–í–´–• –ö–û–ú–ê–ù–î
    if message.text:
        text = message.text.lower().strip()
        
        # –ü—Ä–æ—Ñ–∏–ª—å
        if text == '–ø—Ä–æ—Ñ–∏–ª—å':
            user = user_system.get_or_create_user(
                user_id,
                message.from_user.username or message.from_user.first_name
            )
            
            profile_text = f"""<b>üë§ –ü–†–û–§–ò–õ–¨ –í –ß–ê–¢–ï</b>

üöµ‚Äç‚ôÄÔ∏è <b>–ù–∏–∫:</b> {user['username']}
ü™™ <b>ID:</b> {user['user_id']}
üí∑ <b>PL:</b> {user['pl']:.2f}
üí¨ <b>–°–æ–æ–±—â–µ–Ω–∏–π:</b> {user['messages']}
üé≥ <b>–°—Ç—Ä–∞–π–∫–∏:</b> {user['strikes']}"""
            
            bot.reply_to(message, profile_text, parse_mode='HTML')
        
        # –¢–æ–ø
        elif text == '—Ç–æ–ø':
            top_text = user_system.get_top_users(5)
            bot.reply_to(message, top_text, parse_mode='HTML')
        
        # –ë–∞–ª–∞–Ω—Å
        elif text == '–±–∞–ª–∞–Ω—Å':
            user = user_system.get_or_create_user(user_id)
            balance_text = f"""üí∑ <b>–í–ê–® –ë–ê–õ–ê–ù–° PL:</b> {user['pl']:.2f}

üìà <b>–°–æ–æ–±—â–µ–Ω–∏–π:</b> {user['messages']}
üéØ <b>–î–æ PL:</b> {max(0, 100 - user['messages'])}"""
            
            bot.reply_to(message, balance_text, parse_mode='HTML')
        
        # –ò–Ω—Ñ–æ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (–æ—Ç–≤–µ—Ç–æ–º)
        elif text == '–∏–Ω—Ñ' and message.reply_to_message:
            target_user = message.reply_to_message.from_user
            user = user_system.get_or_create_user(
                target_user.id,
                target_user.username or target_user.first_name
            )
            
            info_text = f"""<b>üìä –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï</b>

üë§ <b>–ù–∏–∫:</b> {user['username']}
ü™™ <b>ID:</b> {user['user_id']}
üí∑ <b>PL:</b> {user['pl']:.2f}
üí¨ <b>–°–æ–æ–±—â–µ–Ω–∏–π:</b> {user['messages']}
üìÖ <b>–ê–∫—Ç–∏–≤–µ–Ω:</b> {datetime.fromtimestamp(user['last_active']).strftime('%d.%m.%Y')}"""
            
            bot.reply_to(message, info_text, parse_mode='HTML')
        
        # –ò–Ω—Ñ–æ –ø–æ ID
        elif text.startswith('–∏–Ω—Ñ '):
            parts = text.split()
            if len(parts) >= 2:
                try:
                    target_id = int(parts[1])
                    
                    # –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
                    target_user_data = None
                    for uid, data in user_system.users.items():
                        if data['user_id'] == target_id:
                            target_user_data = data
                            break
                    
                    if target_user_data:
                        info_text = f"""<b>üìä –ò–ù–§–û–†–ú–ê–¶–ò–Ø –ü–û ID</b>

üë§ <b>–ù–∏–∫:</b> {target_user_data['username']}
ü™™ <b>ID:</b> {target_user_data['user_id']}
üí∑ <b>PL:</b> {target_user_data['pl']:.2f}
üí¨ <b>–°–æ–æ–±—â–µ–Ω–∏–π:</b> {target_user_data['messages']}"""
                    else:
                        info_text = f"‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID {target_id} –Ω–µ –Ω–∞–π–¥–µ–Ω"
                    
                    bot.reply_to(message, info_text, parse_mode='HTML')
                
                except ValueError:
                    bot.reply_to(message, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID")
        
        # –ü–µ—Ä–µ–≤–æ–¥ PL
        elif text.startswith('–ø–µ—Ä–µ–¥–∞—Ç—å '):
            parts = text.split()
            if len(parts) >= 3:
                try:
                    target_id = int(parts[1])
                    amount = float(parts[2])
                    
                    result = user_system.transfer_pl(user_id, target_id, amount)
                    bot.reply_to(message, result, parse_mode='HTML')
                
                except (ValueError, IndexError):
                    bot.reply_to(message, "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: –ø–µ—Ä–µ–¥–∞—Ç—å [ID] [—Å—É–º–º–∞]")
        
        # –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∫–ª–∞–Ω–æ–≤
        elif text.startswith('–≤—Å—Ç—É–ø–∏—Ç—å '):
            clan_name = text.replace('–≤—Å—Ç—É–ø–∏—Ç—å ', '', 1).strip()
            if clan_name:
                response = f"""‚úÖ <b>–ó–ê–Ø–í–ö–ê –ù–ê –í–°–¢–£–ü–õ–ï–ù–ò–ï</b>

üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @{message.from_user.username or message.from_user.id}
üè∞ –ö–ª–∞–Ω: {clan_name}

–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≥–ª–∞–≤–µ –∫–ª–∞–Ω–∞.
–û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è."""
                
                bot.reply_to(message, response, parse_mode='HTML')
        
        elif text.startswith('–≤—ã–π—Ç–∏ '):
            clan_name = text.replace('–≤—ã–π—Ç–∏ ', '', 1).strip()
            if clan_name:
                response = f"""‚úÖ <b>–ó–ê–Ø–í–ö–ê –ù–ê –í–´–•–û–î</b>

üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @{message.from_user.username or message.from_user.id}
üè∞ –ö–ª–∞–Ω: {clan_name}

–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞."""
                
                bot.reply_to(message, response, parse_mode='HTML')

# ========== –û–ë–†–ê–ë–û–¢–ö–ê –õ–ò–ß–ù–´–• –°–û–û–ë–©–ï–ù–ò–ô ==========

@bot.message_handler(func=lambda m: m.chat.type == 'private')
def handle_private_message(message):
    # –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –∫–æ–º–∞–Ω–¥–∞ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞"
    if not message.text or not message.text.startswith('/'):
        bot.reply_to(message, "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /help –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥")

# ========== –ó–ê–ü–£–°–ö –ë–û–¢–ê ==========

if __name__ == "__main__":
    print("ü§ñ –ë–æ—Ç PLAZWAR –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    print(f"üìç –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç: {PLAZCHAT_CHAT_ID}")
    print(f"üìä –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(user_system.users)}")
    print(f"‚ö†Ô∏è  –¢—Ä–∏–≥–≥–µ—Ä–æ–≤: {len(trigger_system.triggers)}")
    print("=" * 50)
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    try:
        bot.infinity_polling()
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞: {e}")
üìö –û–ë–™–Ø–°–ù–ï–ù–ò–ï –ö–ê–ñ–î–û–ì–û –ö–û–ú–ü–û–ù–ï–ù–¢–ê:
1. –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•:
users.json - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∏–∫, —Å–æ–æ–±—â–µ–Ω–∏—è, PL, ID)

triggers.json - —Å–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Å–ª–æ–≤ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏

warnings.json - –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

2. –ö–õ–ê–°–°–´ –°–ò–°–¢–ï–ú:
DataStorage - —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏:
load_json() - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON

save_json() - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ JSON

TriggerSystem - —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:
check_message() - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã

add_warning() - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

add_trigger() / remove_trigger() - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏

UserSystem - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
get_or_create_user() - —Å–æ–∑–¥–∞–Ω–∏–µ/–ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

add_message() - –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ PL –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

transfer_pl() - –ø–µ—Ä–µ–≤–æ–¥ PL –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

get_top_users() - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤

3. –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ê–î–ú–ò–ù–û–í:
/triggers - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏

/warnings @user - –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

/ban @user - –±–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)

/reset_warnings ID - —Å–±—Ä–æ—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

4. –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´ –í –ß–ê–¢–ï:
–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ PL:
–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ plazchat = +1 –∫ —Å—á–µ—Ç—á–∏–∫—É

–ü–æ—Å–ª–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π = +0.5 PL –∑–∞ –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

–ê–Ω—Ç–∏—Ñ–ª—É–¥: 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:
–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Å–ª–æ–≤

–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã - —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª—è–µ—Ç—Å—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

–ü—Ä–∏ 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö - –±–∞–Ω –Ω–∞ 1 —á–∞—Å

–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç–µ:
–ø—Ä–æ—Ñ–∏–ª—å - –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

—Ç–æ–ø - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤

–±–∞–ª–∞–Ω—Å - –±–∞–ª–∞–Ω—Å PL

–∏–Ω—Ñ - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ)

–∏–Ω—Ñ [ID] - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ID

–ø–µ—Ä–µ–¥–∞—Ç—å [ID] [—Å—É–º–º–∞] - –ø–µ—Ä–µ–≤–æ–¥ PL

–≤—Å—Ç—É–ø–∏—Ç—å [–∫–ª–∞–Ω] - –∑–∞—è–≤–∫–∞ –≤ –∫–ª–∞–Ω

–≤—ã–π—Ç–∏ [–∫–ª–∞–Ω] - –≤—ã—Ö–æ–¥ –∏–∑ –∫–ª–∞–Ω–∞

5. –ö–û–ú–ê–ù–î–´ –í –õ–ò–ß–ö–ï:
/start - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

/help - —Å–ø—Ä–∞–≤–∫–∞

/profile - –ø—Ä–æ—Ñ–∏–ª—å

/top - —Ç–æ–ø –∏–≥—Ä–æ–∫–æ–≤

/give [ID] [—Å—É–º–º–∞] - –ø–µ—Ä–µ–≤–æ–¥ PL

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è = "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞"

üõ† –ù–ê–°–¢–†–û–ô–ö–ê:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
bash
pip install pyTelegramBotAPI
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
python
# –ó–∞–º–µ–Ω–∏—Ç–µ —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è:
BOT_TOKEN = '–í–ê–®_–¢–û–ö–ï–ù'  # –ü–æ–ª—É—á–∏—Ç–µ —É @BotFather
PLAZCHAT_CHAT_ID = -1002222950483  # ID —á–∞—Ç–∞ @plazchat
ADMIN_IDS = [123456789]  # –í–∞—à ID Telegram
3. –ü–æ–ª—É—á–∏—Ç–µ ID —á–∞—Ç–∞:
python
# –î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–¥ –≤—Ä–µ–º–µ–Ω–Ω–æ:
@bot.message_handler(commands=['getid'])
def get_chat_id(message):
    bot.reply_to(message, f"Chat ID: {message.chat.id}")

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /getid –≤ –Ω—É–∂–Ω–æ–º —á–∞—Ç–µ
4. –¢—Ä–∏–≥–≥–µ—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
json
["—Ä–µ–∫–ª–∞–º–∞", "—Å–ø–∞–º", "–æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏–µ", "–º–∞—Ç", "—Å–∫–∞–º", "—Ä–∞–∑–≤–æ–¥", "–æ–±–º–∞–Ω", "–ø–æ—Ä–Ω–æ", "–Ω–∞—Ä–∫–æ—Ç–∏–∫–∏", "–æ—Ä—É–∂–∏–µ", "–Ω–∞—Å–∏–ª–∏–µ", "–º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ"]
üîß –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –°–ò–°–¢–ï–ú–ê –¢–†–ò–ì–ì–ï–†–û–í:
–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç: "–ö—É–ø–∏—Ç–µ —É –º–µ–Ω—è —Ä–µ–∫–ª–∞–º—É –¥–µ—à–µ–≤–æ!"

–ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: —Å–ª–æ–≤–æ "—Ä–µ–∫–ª–∞–º–∞" –µ—Å—Ç—å –≤ —Ç—Ä–∏–≥–≥–µ—Ä–∞—Ö

–î–µ–π—Å—Ç–≤–∏—è –±–æ—Ç–∞:

–£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (—É–¥–∞–ª—è–µ—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫)

–ü—Ä–∏ 3 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö - –±–∞–Ω

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤:
text
–ê–¥–º–∏–Ω: /triggers add —Å–∫–∞–º
–ë–æ—Ç: ‚úÖ –¢—Ä–∏–≥–≥–µ—Ä '—Å–∫–∞–º' –¥–æ–±–∞–≤–ª–µ–Ω

–ê–¥–º–∏–Ω: /triggers
–ë–æ—Ç: –°–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã—Ö —Å–ª–æ–≤...
üìä –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø–ú–ò:
–ü—Ä–æ—Å–º–æ—Ç—Ä:
text
/triggers - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
/warnings - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏
/warnings 123456789 - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–°–±—Ä–æ—Å:
text
/reset_warnings 123456789 - —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
‚ö° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø:
–î–ª—è –±–æ–ª—å—à–∏—Ö —á–∞—Ç–æ–≤:
python
# –£–≤–µ–ª–∏—á—å—Ç–µ –∞–Ω—Ç–∏—Ñ–ª—É–¥ –∑–∞–¥–µ—Ä–∂–∫—É
ANTI_FLOOD_DELAY = 1  # 1 —Å–µ–∫—É–Ω–¥–∞

# –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –¥–æ –±–∞–Ω–∞
WARNINGS_LIMIT = 2

# –£–º–µ–Ω—å—à–∏—Ç–µ –≤—Ä–µ–º—è –±–∞–Ω–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
BAN_DURATION = 300  # 5 –º–∏–Ω—É—Ç
–î–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
python
# –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
trigger_cache = {}

def check_message_cached(message):
    text_hash = hash(message.text)
    if text_hash in trigger_cache:
        return trigger_cache[text_hash]
    
    result = trigger_system.check_message(message)
    trigger_cache[text_hash] = result
    return result
üö® –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø:
1. –ü—Ä–∞–≤–∞ –±–æ—Ç–∞ –≤ —á–∞—Ç–µ:
–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

–ü—Ä–∞–≤–∞: —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –±–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Telegram:
–ú–∞–∫—Å–∏–º—É–º 20 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É –æ—Ç –±–æ—Ç–∞

–ù–µ–ª—å–∑—è –±–∞–Ω–∏—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ —Å–µ–∫—Ä–µ—Ç–µ

–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞–º

–†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö

üìà –†–ê–°–®–ò–†–ï–ù–ò–ï –§–£–ù–ö–¶–ò–û–ù–ê–õ–ê:
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏:
python
# 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
NIGHT_MODE = False  # –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è –Ω–æ—á—å—é

# 2. –£–º–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã (—Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è)
SMART_TRIGGERS = [
    r"\b–∫—É–ø–∏(—Ç–µ)?\b.*\b—Ä–µ–∫–ª–∞–º[–∞—É—ã]\b",
    r"\b–±–µ—Å–ø–ª–∞—Ç–Ω(—ã–π|–∞—è|–æ–µ)\b.*\b–¥–µ–Ω—å–≥–∏\b"
]

# 3. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏
REPUTATION_SYSTEM = {
    'good_message': +1,
    'bad_message': -3,
    'ban_threshold': -10
}

# 4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π
def log_action(user_id, action, details):
    with open('moderation.log', 'a') as f:
        f.write(f"{datetime.now()} | {user_id} | {action} | {details}\n")
üêõ –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö:
–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:
"Chat not found" - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ ID —á–∞—Ç–∞

"Not enough rights" - –¥–∞–π—Ç–µ –±–æ—Ç—É –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞

"Message to delete not found" - —Å–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ —É–¥–∞–ª–µ–Ω–æ

"Flood control" - —É–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:
–¢–µ—Å—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:
python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
@bot.message_handler(commands=['test_trigger'])
def test_trigger(message):
    test_message = type('obj', (object,), {
        'text': '–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∫–ª–∞–º—É',
        'from_user': message.from_user
    })
    
    triggers = trigger_system.check_message(test_message)
    bot.reply_to(message, f"–ù–∞–π–¥–µ–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä—ã: {triggers}")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
@bot.message_handler(commands=['stats'])
def show_stats(message):
    stats = f"""üìä <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–û–¢–ê</b>

üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(user_system.users)}
‚ö†Ô∏è  –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π: {sum([w['count'] for w in trigger_system.warnings.values()])}
üö´ –¢—Ä–∏–≥–≥–µ—Ä–æ–≤: {len(trigger_system.triggers)}
üíé –í—Å–µ–≥–æ PL –≤ —Å–∏—Å—Ç–µ–º–µ: {sum([u['pl'] for u in user_system.users.values()]):.2f}"""
    
    bot.reply_to(message, stats, parse_mode='HTML')
üöÄ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –ü—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞.
